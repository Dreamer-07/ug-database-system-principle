# 数据库系统原理

# 第一章 数据库系统概述

## 1.1 数据库基本概念

- **数据**：是 **描述事物的符号记录**，是指用物理符号记录下来，可以鉴别的信息

- **数据库：**是 **长期存储在计算机内的有组织的，可共享的大量数据集合**

  - 数据库存储的数据特点：**长期存储的、有组织的、可共享的**

- 数据库管理系统(DBMS)：是位于 **用户与操作系统** 之间的一层 **数据库管理软件**

  - 主要功能

    1. **数据定义功能**：提供数据定义语言(DDL)，定义数据库中的数据对象

       例如：表、视图、存储过程、触发器等

    2. **数据操作功能**：提供数据操作语言(DML)，操作数据实现对数据库的基本操作

       例如：增删查改

    3. **数据库的运行管理：**保证数据的安全性，完整性、高并发、以及故障修复

    4. **数据库的建立和维护功能**

    5. **数据组织、存储和管理功能**

    6. **其他功能**：网络通信；不同数据库管理系统之间的相互传输

- 数据库系统(DBS)：指在计算机中引入数据库技术之后的系统

  - 通常一个完整的数据库系统应该包括 **数据库、数据库管理系统及相关使用工具、应用程序、数据库管理员和用户**
  - 数据库管理员(DBA)：专门对数据库进行维护，并保证数据库正常，高效运行

## 1.2 数据管理技术的发展

1. 人工管理阶段
   - 特点
     1. **数据不保存**
     2. **应用程序管理数据**
     3. **数据面向应用**
   - 总结：**记录内无结构，整体无结构**
2. 文件系统阶段
   - 特点
     1. 数据的管理者：文件系统，**数据可长期保存**
     2. 数据面向的对象：某一应用程序
     3. 数据的共享程度：**共享性差，冗余度大**
     4. 数据的结构化：**记录内有结构，整体无结构**
     5. 数据的独立性：**独立性差**，数据的逻辑结构改变必须修改应用程序
     6. 数据控制能力：应用程序自己控制
3. 数据库系统阶段
   - 特点
     1. **数据集成**
     2. **数据共享性高**
     3. **数据冗余小**：(没有太多的重复数据)
     4. **数据一致性**
     5. **数据独立性高:** (数据和应用是分开的)
     6. **实施统一管理与控制**
     7. 减少应用程序开发与维护的工作量

## 1.3 数据库系统的结构

- 数据库系统的三种模式结构

  1. **模式**：

     也称为 **概念模式或逻辑模式**，它是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图

  2. **外模式**：

     也称为 **子模式或用户模式**，数据库用户(包括应用程序员和最终用户)能够看见和使用的局部数据的逻辑结构和特征的描述

     DBMS 提供子模式描述语言 (DDL) 来严格定义子模式 

  3. **内模式**

     也称为 **存储模式**，它是对数据库中数据物理结构和存储方式的描述，是数据在数据库内部的表示形式

  4. 三级模式结构的两层映像和数据独立性(逻辑 and 物理)

     1. 外模式/模式映像 - 逻辑独立性
     2. 模式/内模式映像 - 物理独立性

- 数据库系统的运行与应用结构

  1. B/S
  2. C/S

## 1.4 数据模型

- 数据特征与**数据模型组成要素**

  1. **数据结构**

     数据结构描述的是系统的 **静态特性**，即数据对象的数据类型、内容、属性以及数据对象之间的联系

  2. **数据操作**

     数据操作描述的是系统的 **动态特性**，是对各种数据对象的实例允许执行的操作的集合，包括操作及有关操作规则

  3. **数据的约束条件**

     用来保证数据的正确性、有效性、相容性

- 数据模型的分类

  1. **概念层模型数据**

     1. 信息世界中的基本概念

        - 实体：客观存在并可相互区别的事物
        - 属性：实体所具有的某一特性称为属性
        - 码：唯一标识实体的属性集称为码
        - 域：属性的取值范围称为该属性的域
        - 实体型：实体 Type
        - 实体集：实体 Set
        - 联系
          - 一对多
          - 一对一
          - 多对多

     2. **概念模型的表示方法**

        - 概念模型：用来描述现实世界的事物之间的关系，与计算机系统无关

        - 最典型的概念模型是 **实体联系(E-R)**

          ![image-20210214210717073](README.assets/image-20210214210717073.png)

  2. 逻辑层数据模型

     1. 层次模型
     2. 网状模型
     3. **关系模型**
     4. 面向对象模型

  3. 物理层数据模型

     也称为数据的物理模型，是逻辑模型的物理实现，即每一种逻辑模型在实现时都有与之相对应的物理模型

# 第二章 关系数据库

## 2.1 (了解即可)概述

![image-20210214215452703](README.assets/image-20210214215452703.png)

关系数据库应用 **数学方法** 来处理数据库中的数据

## 2.2 关系数据模型

### 1) 关系数据结构

> 关系模型的数据结构就是单一的数据结构，即关系(也就是二维表)

- 基本术语

  1. 表

     也称关系，是一个二维的数据结构，有表名、构成表的各个列、若干行数据组成

     每个表都有一个唯一的表名，表中的每一行数据描述一条具体的记录值

  2. 关系

     一个关系对应一张二维表(逻辑上)；可以为每个关系取一个名称进行表示(逻辑上就是表名)

  3. 列

     也称为字段、属性；表中的每一列都有一个名称，称为列名、字段名。属性名

     每一列表示实体一个属性，具有相同的数据类型

  4. 属性

     表示的一列即使一个属性。表中属性的个数称为关系的元/度；属性值的取值范围就是值域

  5. 行

     也称为记录、元组

  6. 元组

     表中的一行

  7. 分量

     元组中的一个属性值，称为分量

  8. 码

     在一个关系中，可以唯一标识任意一个元组，称为该关系的码/键

  9. 超码/超键

     当某一个关系中的一个码移除了某个属性的话，它仍然是这个关系的码。就称为超码/超键

  10. 候选码/候选键

      当某一个关系中的一个码移除了某个属性的话，就不再是这个关系的码，就称为候选码/候选键

  11. 主码/主键

      在一个关系的若干个候选码或候选键中指定一个用来唯一标识关系的元组

      则称这个被指定的候选码或候选键为该关系的主码或主键

  12. 全码/全键

      一个关系模型的所有属性是这个关系的主码/主键，则称这样的主码/主键为全码/全键

  13. 主属性和非主属性

      关系中包含任何一个候选码的属性称为主属性，不包含任何一个候选码的属性称为非主属性

  14. 外码/外键

      当关系中的某个属性不是这个关系的主码/候选码，而是另一关系的主码时，称该属性(/属性组)为这个关系的外键/外码

  15. 参照关系和被参照关系

      参照关系又称为从关系，被参照关系又称为主关系，它们是以外码相关联的两个关系

      以外码为主码的关系称为参照关系，外码所在的关系称为被参照关系

  16. 域

      属性的取值范围

  17. 数据类型

      每一个列都有一个相应的数据类型，用来约束数据

  18. 关系模型

      每一个关系与对应的字段(属性、列)

  19. 关系数据库

      以关系模型作为数据的逻辑模型，

      并采用关系作为数据组织方式的一类数据库，

      其数据库操作建立在关系代数的基础上

### 2) 关系操作集合

#### 一、基本的关系操作

1. 查询
2. 数据更新
3. 关系操作的**特点：**集合操作方式，即操作的对象和结果都是集合

#### 二、关系数据语言的分类 

- 关系操作的能力可以用两种方式来表示：**代数方式**和**逻辑方式**

  - 代数方式主要有关系代数，通过**对关系的操作**来表达查询要求的方式

    包括：集合运算符、专门的关系运算符、比较运算符、逻辑运算符

  - 逻辑方式主要有关系演算，它使用**谓词**来表达查询要求的方式

- 具有关系代数和关系演算双重特点的语言：**SQL**

#### 三、关系代数

1. 传统的集合运算

   > 并、差、交、广义笛卡尔积

   - 并：将两个表的所有记录合并为一个集合
   - 交：将两个表中相同的记录合并为一个集合
   - 差：将一个表中的记录减去另一个表中的记录，得到一个集合
   - 笛卡尔积：(两个表的结构可能不相同)用一个表中的所有记录分别匹配另一个表中的所有记录

2. 专门的关系运算

   > 选择、投影、连接、除

   - 选择

     语法：`SELECT 关系名 WHERE 条件`

     其中条件是由常数、属性名或列名、比较操作符和逻辑运算符组成的条件表达式

     ![image-20210214231814927](README.assets/image-20210214231814927.png)

   - 投影：保留指定列的所有记录

   - 连接：

     语法：`JOIN 关系名1 AND 关系名2 WHERE 条件`

   - 除：连接的逆运算

### 3) 关系的完整性约束

1. 实体完整性约束

   指关系的主属性，即主码的组成不能为空(不能是空值 NULL)

2. 参照完整性约束

3. 用户定义完整性约束

4. 关系模型完整性约束的检验

   - 执行插入数据
   - 执行删除操作
   - 执行更新操作

## 2.3 关系数据的规范化理论

### 1) 关系模式中可能存在的冗余和异常问题

1. 数据冗余
2. 更新异常
3. 插入异常
4. 删除异常

![image-20210214235038140](README.assets/image-20210214235038140.png)



